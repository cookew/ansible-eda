#cloud-metadata
instance-id: {{ inventory_hostname_short }}
local-hostname: {{ inventory_hostname_short }}
redact:
- metadata
- userdata
network:
    version: 2
    ethernets:
        ens32:
            match:
                name: ens32
            dhcp4: false
            dhcp6: false
            addresses:
                - {{ ipv4[0].address }}/{{ ipv4[0].cidr }}
{% if ipv6[0].address %}                - {{ ipv6[0].address }}/{{ ipv6[0].cidr }}
{% endif %}
            nameservers:
                addresses:
                    - {{ dns_server }}
                search:
                    - {{ domain_name }}
            routes:
                - to: 0.0.0.0/0
                  via: {{ ipv4_gateway }}
{% if ipv6_gateway is defined %}                - to: ::/0
                  via: {{ ipv6_gateway }}{% endif %}
