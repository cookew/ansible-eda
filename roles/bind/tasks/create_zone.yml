- name: Create zone files
  become: true
  notify: rndc
  loop: "{{ bind_catalog_zones }}"
  loop_control:
    label: "{{ zone.zone }}"
    loop_var: zone
  register: zones_updated
  when:
    - bind_is_primary_server is defined and bind_is_primary_server
    - zone.type == "primary"
  ansible.builtin.template:
    dest: /var/lib/bind/zones/{{ zone.zone }}
    group: "{{ bind_distro_info[ansible_facts.distribution].group_name }}"
    mode: "0660"
    owner: "{{ bind_distro_info[ansible_facts.distribution].owner_name }}"
    src: template.primary.j2


- name: Flush handlers
  ansible.builtin.meta: flush_handlers
